function _autop_newline_preservation_helper (e) {
  return e[0].replace('\n', '<WPPreserveNewline />')
}

function wpautop (e, r) {
  void 0 === r && (r = !0)
  var p = new Map
  if ('' === e.trim()) return ''
  if ((e += '\n').indexOf('<pre') > -1) {
    var i = e.split('</pre>'), n = i.pop()
    e = '', i.forEach(function (r, i) {
      var n = r.indexOf('<pre')
      if (-1 !== n) {
        var a = '<pre wp-pre-tag-' + i + '></pre>'
        p[a] = r.substr(n) + '</pre>', e += r.substr(0, n) + a
      } else e += r
    }), e += n
  }
  var a = '(?:table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)';
  (e = (e = (e = (e = e.replace(/<br \/>\s*<br \/>/, '\n\n')).replace(
    new RegExp('(<' + a + '[^>]*>)', 'gmi'), '\n$1')).replace(
    new RegExp('(</' + a + '>)', 'gmi'), '$1\n\n')).replace(/\r\n|\r/,
    '\n')).indexOf('<option') > -1 &&
  (e = (e = e.replace(/\s*<option'/gim, '<option')).replace(/<\/option>\s*/gim,
    '</option>')), e.indexOf('</object>') > -1 &&
  (e = (e = (e = e.replace(/(<object[^>]*>)\s*/gim, '$1')).replace(
    /\s*<\/object>/gim, '</object>')).replace(
    /\s*(<\/?(?:param|embed)[^>]*>)\s*/gim, '$1')), (e.indexOf('<source') >
    -1 || e.indexOf('<track') > -1) &&
  (e = (e = (e = e.replace(/([<\[](?:audio|video)[^>\]]*[>\]])\s*/gim,
    '$1')).replace(/\s*([<\[]\/(?:audio|video)[>\]])/gim, '$1')).replace(
    /\s*(<(?:source|track)[^>]*>)\s*/gim, '$1'))
  var l = (e = e.replace(/\n\n+/gim, '\n\n')).split(/\n\s*\n/)
  return e = '', l.forEach(function (r) {
    e += '<p>' + r.replace(/^\s+|\s+$/g, '') + '</p>\n'
  }), e = (e = (e = (e = (e = (e = (e = (e = e.replace(/<p>\s*<\/p>/gim,
    '')).replace(/<p>([^<]+)<\/(div|address|form)>/gim,
    '<p>$1</p></$2>')).replace(
    new RegExp('<p>s*(</?' + a + '[^>]*>)s*</p>', 'gmi'), '$1', e)).replace(
    /<p>(<li.+?)<\/p>/gim, '$1')).replace(/<p><blockquote([^>]*)>/gim,
    '<blockquote$1><p>')).replace(/<\/blockquote><\/p>/gim,
    '</p></blockquote>')).replace(
    new RegExp('<p>s*(</?' + a + '[^>]*>)', 'gmi'), '$1')).replace(
    new RegExp('(</?' + a + '[^>]*>)s*</p>', 'gmi'), '$1'), r &&
  (e = (e = (e = e.replace(/<(script|style)(?:.|\n)*?<\/\\1>/gim,
    _autop_newline_preservation_helper)).replace(/(<br \/>)?\s*\n/gim,
    '<br />\n')).replace('<WPPreserveNewline />',
    '\n')), e = (e = (e = e.replace(
    new RegExp('(</?' + a + '[^>]*>)s*<br />', 'gmi'), '$1')).replace(
    /<br \/>(\s*<\/?(?:p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)/gim,
    '$1')).replace(/\n<\/p>$/gim, '</p>'), Object.keys(p).length &&
  (e = e.replace(new RegExp(Object.keys(p).join('|'), 'gi'),
    function (e) {return p[e]})), e
}
